(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{353:function(t,s,e){"use strict";e.r(s);var a=e(43),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("公司内网有台8核8G的服务器可以用来玩。虽然配置不是太高，但是相对于自己1核2G的学生机来说已经不知道强到哪里了。但由于是内网的缘故只能在公司内访问，虽然通过远程桌面也能使用，但是这样未免太low了。于是想到用ssh来进行端口转发，在家也能访问内网服务器。")]),t._v(" "),e("h3",{attrs:{id:"条件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#条件"}},[t._v("#")]),t._v(" 条件")]),t._v(" "),e("p",[e("font",{attrs:{color:"#FF0000",size:"5",face:"黑体"}},[e("strong",[t._v("内网服务器必须能连外网")])])],1),t._v(" "),e("p",[t._v("服务器信息如下：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("服务器名称")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("服务器ip")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("ssh端口")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("服务器配置")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("公网服务器")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("122.34.122.32")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("54374")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("1核2G")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("内网服务器")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("172.18.10.23")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("22")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("8核8G")])])])]),t._v(" "),e("h3",{attrs:{id:"步骤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤"}},[t._v("#")]),t._v(" 步骤")]),t._v(" "),e("p",[t._v("1.在内网服务器上执行：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ssh -N -f -R [122.34.122.32:]10022:172.18.10.23:22 root@122.34.122.32 -p54374\n")])])]),e("p",[t._v("参数解释：")]),t._v(" "),e("p",[e("strong",[t._v("-N")]),t._v(":不执行远程命令，如果ssh仅仅是用来转发端口很有用。")]),t._v(" "),e("blockquote",[e("p",[t._v("Do not execute a remote command.  This is useful for just forwarding ports.")])]),t._v(" "),e("p",[e("strong",[t._v("-f")]),t._v(":将本条命令放到后台执行，防止内网服务器ssh窗口关闭导致无法连接到内网服务器")]),t._v(" "),e("p",[e("strong",[t._v("-R")]),t._v(":设置转发规则，本条规则是把本地22端口的请求转发到122.34.122.32的10022端口，形成一条通路。")]),t._v(" "),e("p",[e("strong",[t._v("-p 54374")]),t._v(":指定公网服务器的ssh端口用于登录")]),t._v(" "),e("p",[t._v("2.登录公网服务器，查询端口发现端口已经监听：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("[root@bochs ~]# ss -tnl | grep :10022\nLISTEN     0      128          *:10022                 *:*                  \nLISTEN     0      128       [::]:10022                 [::]:* \n")])])]),e("p",[t._v("3.在122.34.122.32连接10022端口,输入内网服务器的root密码登录：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ssh -p10022 122.34.122.32\n")])])]),e("p",[t._v("命令执行完成即已登录到内网服务器")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("top - 23:14:46 up 22 days,  5:26,  2 users,  load average: 0.00, 0.01, 0.05\nTasks: 280 total,   2 running, 278 sleeping,   0 stopped,   0 zombie\n%Cpu0  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\n%Cpu1  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\n%Cpu2  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\n%Cpu3  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\n%Cpu4  :  0.0 us,  2.6 sy,  0.0 ni, 97.4 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\n%Cpu5  :  0.0 us,  2.7 sy,  0.0 ni, 97.3 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\n%Cpu6  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\n%Cpu7  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\nKiB Mem :  8008440 total,  5914008 free,   730108 used,  1364324 buff/cache\nKiB Swap:        0 total,        0 free,        0 used.  6954304 avail Mem \n")])])]),e("p",[t._v("真香！")]),t._v(" "),e("h3",{attrs:{id:"延伸"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#延伸"}},[t._v("#")]),t._v(" 延伸")]),t._v(" "),e("p",[t._v("如果内网的服务器上有mysql同样可以使用端口转发访问内网的mysql")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ssh -N -f -R 33060:172.18.10.23:3306 root@122.34.122.32 -p54374\n\nmysql -h127.0.0.1 -P33060 -uroot -p \n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);